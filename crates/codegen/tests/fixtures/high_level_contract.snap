---
source: crates/codegen/tests/yul.rs
assertion_line: 31
expression: output
input_file: tests/fixtures/high_level_contract.fe
---
object "EchoContract" {
  code {
    init()
    function init() {
      let v0 := datasize("EchoContract_deployed")
      let v1 := dataoffset("EchoContract_deployed")
      codecopy(0, v1, v0)
      return(0, v0)
    }
  }

  object "EchoContract_deployed" {
    code {
      runtime()
      function alloc(size) -> ret {
        let v0 := mload(64)
        let v1 := eq(v0, 0)
        if v1 {
          v0 := 128
          mstore(64, add(v0, size))
          ret := v0
        }
        if iszero(v1) {
          mstore(64, add(v0, size))
          ret := v0
        }
      }
      function cursor_i__fork_mem__CallData__b9ab8dc8a4b2f9e(self, pos) -> ret {
        let v0 := alloc(32)
        store_field__deduped(v0, 0, pos)
        let v1 := v0
        ret := v1
      }
      function cursor_i__new__CallData__b9ab8dc8a4b2f9e(input) -> ret {
        let v0 := alloc(32)
        store_field__deduped(v0, 0, 0)
        let v1 := v0
        ret := v1
      }
      function decode_____Sol_SolDecoder_CallData___7a33f8e14ea06d71(d) -> ret {
        ret := 0
      }
      function decode___u256__Sol_SolDecoder_CallData___6bbc79d2596eeb59(d) -> ret {
        let v0 := decode__Sol__u256__SolDecoder_CallData___2b0102c53e22c9ee(d)
        ret := 0
      }
      function encode__u256_Sol_SolEncoder__ce94c1790aa7f5c9(self, e) {
        write_word__Sol_u256__cb19b1dcad253a4a(e, self)
      }
      function finish__SolEncoder_Sol__822e2f0488b7f288(self) -> ret {
        let v0 := alloc(64)
        store_field__deduped(v0, 0, mload(self))
        store_field__deduped(v0, 32, sub(mload(add(self, 64)), mload(self)))
        ret := v0
      }
      function get_field__MemPtr_u256__97fe9178c4597e85(ptr, offset) -> ret {
        let v0 := add(ptr, offset)
        ret := decode_____Sol_SolDecoder_CallData___7a33f8e14ea06d71(load__MemPtr__d0292394fccae3e4(v0))
      }
      function load__MemPtr__d0292394fccae3e4(addr) -> ret {
        ret := mload(addr)
      }
      function recv_EchoMsg_Answer_0_0(args) -> ret {
        ret := 42
      }
      function recv_EchoMsg_Echo_0_1(args) -> ret {
        let v0 := mload(args)
        ret := v0
      }
      function reserve_head__SolEncoder_Sol__822e2f0488b7f288(self, bytes) -> ret {
        solencoder_ensure_init_mem(self, bytes)
        ret := mload(self)
      }
      function runtime() {
        let v0 := 0
        let v1 := lt(calldatasize(), 4)
        if v1 {
          revert(0, 0)
        }
        if iszero(v1) {
          let v2 := selector_from_prefix__Sol__c9e55515628bbda1(calldataload(0))
          switch v2
            case 1 {
              let v3 := soldecoder_i__with_base__CallData__b9ab8dc8a4b2f9e(v0, 4)
              let v4 := lt(calldatasize(), add(4, 0))
              if v4 {
                revert(0, 0)
              }
              if iszero(v4) {
                let v5 := decode_____Sol_SolDecoder_CallData___7a33f8e14ea06d71(v3)
                let v6 := recv_EchoMsg_Answer_0_0(v5)
                let v7 := solencoder_new()
                pop(reserve_head__SolEncoder_Sol__822e2f0488b7f288(v7, 32))
                encode__u256_Sol_SolEncoder__ce94c1790aa7f5c9(v6, v7)
                let v8 := finish__SolEncoder_Sol__822e2f0488b7f288(v7)
                return(mload(v8), mload(add(v8, 32)))
              }
            }
            case 2 {
              let v9 := soldecoder_i__with_base__CallData__b9ab8dc8a4b2f9e(v0, 4)
              let v10 := lt(calldatasize(), add(4, 32))
              if v10 {
                revert(0, 0)
              }
              if iszero(v10) {
                let v11 := decode___u256__Sol_SolDecoder_CallData___6bbc79d2596eeb59(v9)
                let v12 := recv_EchoMsg_Echo_0_1(v11)
                let v13 := solencoder_new()
                pop(reserve_head__SolEncoder_Sol__822e2f0488b7f288(v13, 32))
                encode__u256_Sol_SolEncoder__ce94c1790aa7f5c9(v12, v13)
                let v14 := finish__SolEncoder_Sol__822e2f0488b7f288(v13)
                return(mload(v14), mload(add(v14, 32)))
              }
            }
            default {
              revert(0, 0)
            }
        }
      }
      function selector_from_prefix__Sol__c9e55515628bbda1(prefix) -> ret {
        ret := shr(224, prefix)
      }
      function soldecoder_i__with_base__CallData__b9ab8dc8a4b2f9e(input, base) -> ret {
        let v0 := cursor_i__fork_mem__CallData__b9ab8dc8a4b2f9e(cursor_i__new__CallData__b9ab8dc8a4b2f9e(input), base)
        let v1 := alloc(64)
        store_field__deduped(v1, 0, get_field__MemPtr_u256__97fe9178c4597e85(v0, 0))
        store_field__deduped(v1, 32, base)
        let v2 := v1
        ret := v2
      }
      function solencoder_ensure_init_mem(self, bytes) {
        let v0 := eq(mload(self), 0)
        if v0 {
          let v1 := alloc(bytes)
          store_field__deduped(self, 0, v1)
          store_field__deduped(self, 32, v1)
          store_field__deduped(self, 64, add(v1, bytes))
        }
        if iszero(v0) {
        }
      }
      function solencoder_new() -> ret {
        let v0 := alloc(96)
        store_field__deduped(v0, 0, 0)
        store_field__deduped(v0, 32, 0)
        store_field__deduped(v0, 64, 0)
        let v1 := v0
        ret := v1
      }
      function store__MemPtr__d0292394fccae3e4(addr, value) {
        mstore(addr, value)
      }
      function store_field__deduped(ptr, offset, value) {
        let v0 := add(ptr, offset)
        store__MemPtr__d0292394fccae3e4(v0, decode_____Sol_SolDecoder_CallData___7a33f8e14ea06d71(value))
      }
    }
  }
}
